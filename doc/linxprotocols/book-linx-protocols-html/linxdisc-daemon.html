<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>5.2 LINX Discovery Daemon</title><link rel="stylesheet" href="html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.73.2"><meta name="keywords" content=""><link rel="start" href="title.html" title="LINX Protocols"><link rel="up" href="eth_cm_manager.html" title="5. Enea LINX Ethernet Connection Manager"><link rel="prev" href="eth_cm-proto-desr.html" title="5.1 Protocol Descriptions"><link rel="next" href="ptp_cm_manager.html" title="6. Enea LINX Point-To-Point (PTP) Connection Manager"><base target="body"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><td colspan="2" align="left"><span class="headerbaseline">Document Version 21</span></td><td align="right"><IMG src="images/enea_logo.png"></td></tr><tr><td colspan="3" align="center" valign="bottom"><h2 class="title"><a name="book_linx_proto"></a>LINX Protocols</h2></td></tr><tr><td width="20%" align="left"><a accesskey="p" href="eth_cm-proto-desr.html">Prev</a> </td><th width="60%" align="center">5. Enea LINX Ethernet Connection Manager</th><td width="20%" align="right"> <a accesskey="n" href="ptp_cm_manager.html">Next</a></td></tr></table><hr></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="linxdisc-daemon"></a>5.2 LINX Discovery Daemon</h2></div></div></div><p>The LINX Discovery Daemon,<a class="indexterm" name="id2618586"></a> <span class="bold"><strong>linxdisc</strong></span>, automatically
    discovers LINX network topology and creates links to other LINX hosts.
    Linxdisc finds LINX by periodically broadcasting and listen for LINX
    advertisement messages on available Ethernet interfaces. When
    advertisements from other linxdiscs' arrive linxdisc examines the messages
    and if it passes a number of controls a LINX connection is created to the
    sending host. When a collision occurs, i.e. two or more nodes advertising
    the same name, collision resolution messages are exchanged to determine
    which node gets to remain in the cluster. The node that wins is the one
    that has been up for the longest time, if the nodes can't agree which one
    has been up longest, the node with the highest MAC-address wins. All
    Linxdisc messages from this version and forward carries a version number.
    For this implementaition of Linxdisc all messages containg a higher
    version number are discarded, allowing newer versions of Linxdisc to
    revert to version 1 of the Linxdisc protocol.</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2618619"></a>5.2.1 Linxdisc protocol</h3></div></div></div><p>Connection procedure:</p><h6><a name="id2618628"></a>A-side</h6><p>At startup read configuration file, build a list of all active
      interfaces, extract hostname and cluster name.</p><div class="procedure"><ul><li><p>Periodically broadcast advertisement messages on interfaces
          allowed by the configuration.</p></li></ul></div><h4><a name="id2618653"></a>B-side</h4><div class="procedure"><ol type="1"><li><p>When an advertisement message arrives, linxdisc performs the
          following steps to determine whether to connect to the
          sender:</p><div class="orderedlist"><ol type="a" compact><li><p>Version number matches.</p></li><li><p>Not my own message, i.e. the sender address is the same as
              one of my interfaces.</p></li><li><p>Network cluster name is same as configuration.</p></li><li><p>Name doesn't match mine, if the name is identical to my
              name send a collision resolution message back to sender.</p></li><li><p>Name doesn't match any already established
              connections.</p></li><li><p>Check that the configuration doesn't forbid connections to
              this host.</p></li></ol></div></li><li><p>If all tests pass create a connection to the peer using the
          advertised name and store information about the connection for
          later.</p></li><li><p>When terminated, linxdisc closes all connections it has
          created before exiting.</p></li><li><p>If the configuration is changed, closes connection not allowed
          by the new configuration, and updates advertisements messages to
          reflect the new configuration.</p></li></ol></div><p>When a collision occurs:</p><h4><a name="id2618766"></a>A-side</h4><div class="procedure"><ul><li><p>Send a collision resolution message containing uptime and
          preferred decision.</p></li></ul></div><h4><a name="id2618783"></a>B-side</h4><div class="procedure"><ul><li><p>When receiving a collision resolution message</p><div class="orderedlist"><ol type="a" compact><li><p>Check uptime and preferred decision if in agreement with
              sender refrain from sending advertisements if not in agreement,
              break tie based on MAC-address</p></li></ol></div></li></ul></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id2618821"></a>5.2.1.1 Linxdisc Advertisement Message</h4></div></div></div><div class="table"><a name="id2618827"></a><p class="title"><b>Table 5.9 Linxdisc Advertisement Message</b></p><div class="table-contents"><table summary="Linxdisc Advertisement Message" cellpadding="5" border="1"><colgroup><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col></colgroup><tbody><tr><td><sup>0</sup></td><td><sup>1</sup></td><td><sup>2</sup></td><td><sup>3</sup></td><td><sup>4</sup></td><td><sup>5</sup></td><td><sup>6</sup></td><td><sup>7</sup></td><td><sup>8</sup></td><td><sup>9</sup></td><td><sup>10</sup></td><td><sup>11</sup></td><td><sup>12</sup></td><td><sup>13</sup></td><td><sup>14</sup></td><td><sup>15</sup></td><td><sup>16</sup></td><td><sup>17</sup></td><td><sup>18</sup></td><td><sup>19</sup></td><td><sup>20</sup></td><td><sup>21</sup></td><td><sup>22</sup></td><td><sup>23</sup></td><td><sup>24</sup></td><td><sup>25</sup></td><td><sup>26</sup></td><td><sup>27</sup></td><td><sup>28</sup></td><td><sup>29</sup></td><td><sup>30</sup></td><td><sup>31</sup></td></tr><tr><td colspan="8" align="center">0</td><td colspan="8" align="center">1</td><td colspan="8" align="center">2</td><td colspan="8" align="center">3</td></tr><tr><td colspan="16" align="center">Last 2 bytes
                Ethernet header</td><td colspan="16" align="center">Version</td></tr><tr><td colspan="16" align="center">Type</td><td colspan="16" align="center">Reserved</td></tr><tr><td colspan="32" align="center">Uptime
                sec</td></tr><tr><td colspan="32" align="center">Uptime
                usec</td></tr><tr><td colspan="32" align="center">Linklen</td></tr><tr><td colspan="32" align="center">Netlen</td></tr><tr><td colspan="32" align="center">Strings</td></tr></tbody></table></div></div><br class="table-break"><div class="variablelist"><dl><dt><span class="term">Version</span></dt><dd><p>Linxdisc version type (1).</p></dd><dt><span class="term">Type</span></dt><dd><p>Linxdisc message type, for advertisement (2) is
              used.</p></dd><dt><span class="term">Reserved</span></dt><dd><p>Reserved for future use.</p></dd><dt><span class="term">Uptime sec</span></dt><dd><p>The seconds part of the uptime.</p></dd><dt><span class="term">Uptime usec</span></dt><dd><p>This microsecond part of the uptime.</p></dd><dt><span class="term">Linklen</span></dt><dd><p>Length of linxname, c.f. below.</p></dd><dt><span class="term">Netlen</span></dt><dd><p>Length of netname, c.f. below.</p></dd><dt><span class="term">Strings</span></dt><dd><p>Carries two null-terminated strings, Linkname and Netname
              (network cluster name). Link name is a unique identifier for the
              sending host ment to be used as the name of the link created by
              the receiving linxdisc. Network cluster name is a unique cluster
              id string identifying a group of hosts that will form
              a<a class="indexterm" name="id2619446"></a> <span class="bold"><strong>LINX
              cluster</strong></span>.</p></dd></dl></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="id2619466"></a>5.2.1.2 Linxdisc Collision Resolution Message</h4></div></div></div><div class="table"><a name="id2619473"></a><p class="title"><b>Table 5.10 Linxdisc Collision Resolution Message</b></p><div class="table-contents"><table summary="Linxdisc Collision Resolution Message" cellpadding="5" border="1"><colgroup><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col></colgroup><tbody><tr><td><sup>0</sup></td><td><sup>1</sup></td><td><sup>2</sup></td><td><sup>3</sup></td><td><sup>4</sup></td><td><sup>5</sup></td><td><sup>6</sup></td><td><sup>7</sup></td><td><sup>8</sup></td><td><sup>9</sup></td><td><sup>10</sup></td><td><sup>11</sup></td><td><sup>12</sup></td><td><sup>13</sup></td><td><sup>14</sup></td><td><sup>15</sup></td><td><sup>16</sup></td><td><sup>17</sup></td><td><sup>18</sup></td><td><sup>19</sup></td><td><sup>20</sup></td><td><sup>21</sup></td><td><sup>22</sup></td><td><sup>23</sup></td><td><sup>24</sup></td><td><sup>25</sup></td><td><sup>26</sup></td><td><sup>27</sup></td><td><sup>28</sup></td><td><sup>29</sup></td><td><sup>30</sup></td><td><sup>31</sup></td></tr><tr><td colspan="8" align="center">0</td><td colspan="8" align="center">1</td><td colspan="8" align="center">2</td><td colspan="8" align="center">3</td></tr><tr><td colspan="16" align="center">Last 2 bytes
                Ethernet header</td><td colspan="16" align="center">Version</td></tr><tr><td colspan="16" align="center">Type</td><td colspan="16" align="center">Reserved</td></tr><tr><td colspan="32" align="center">Uptime
                sec</td></tr><tr><td colspan="32" align="center">Uptime
                usec</td></tr><tr><td colspan="32" align="center">Preferred
                decision</td></tr></tbody></table></div></div><br class="table-break"><div class="variablelist"><dl><dt><span class="term">Version</span></dt><dd><p>Linxdisc version type (1).</p></dd><dt><span class="term">Type</span></dt><dd><p>Linxdisc message type, for collision resolution (3) is
              used.</p></dd><dt><span class="term">Reserved</span></dt><dd><p>Reserved for future use.</p></dd><dt><span class="term">Uptime sec</span></dt><dd><p>The seconds part of the uptime.</p></dd><dt><span class="term">Uptime usec</span></dt><dd><p>This microsecond part of the uptime.</p></dd><dt><span class="term">Preferred decision</span></dt><dd><p>Preferred decision on whether the receiver should exit
              from the network.</p></dd></dl></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="eth_cm-proto-desr.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="eth_cm_manager.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ptp_cm_manager.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top"><b>5.1 Protocol Descriptions</b> </td><td width="20%" align="center"><a accesskey="h" href="title.html">Home</a> | <a accesskey="i" href="ix01.html">Index</a></td><td width="40%" align="right" valign="top"> <b>6. Enea LINX Point-To-Point (PTP) Connection Manager</b></td></tr><tr> </tr><tr><td colspan="3" align="center">© Enea Software AB 2011</td></tr></table></div></body></html>
